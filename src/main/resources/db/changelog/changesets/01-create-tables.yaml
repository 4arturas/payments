databaseChangeLog:
  - changeSet:
      id: 1
      author: antigravity
      changes:
        - createTable:
            tableName: payment_groups
            columns:
              - column:
                  name: id
                  type: BIGINT
                  autoIncrement: true
                  constraints:
                    primaryKey: true
                    nullable: false
              - column:
                  name: debtor_iban
                  type: VARCHAR(34)
                  constraints:
                    nullable: false
              - column:
                  name: debtor_name
                  type: VARCHAR(255)
                  constraints:
                    nullable: false
              - column:
                  name: requested_execution_date
                  type: DATE
                  constraints:
                    nullable: false

              # Audit (The "When")
              - column:
                  name: created_at
                  type: TIMESTAMPTZ
                  defaultValueComputed: "CURRENT_TIMESTAMP"
                  constraints:
                    nullable: false
                  remarks: "Audit: Record creation time"

              # Identification (The "What")
              - column:
                  name: external_id
                  type: VARCHAR(255)
                  constraints:
                    nullable: false
                    unique: true
                  remarks: "Unique identifier from the source system (Idempotency Key)"

              - column:
                  name: uname
                  type: VARCHAR(64)
                  constraints:
                    nullable: false
                  remarks: "Owner User ID"

              - column:
                  name: tcif
                  type: VARCHAR(64)
                  constraints:
                    nullable: false
                  remarks: "Account Owner ID"

              - column:
                  name: country
                  type: VARCHAR(2)
                  constraints:
                    nullable: false
                  remarks: "Direct country code mapping (LT, LV, EE)"

              - column:
                  name: source_system
                  type: VARCHAR(64)
                  constraints:
                    nullable: false
                  remarks: "Upstream system identifier"

        - createTable:
            tableName: payments
            columns:
              - column:
                  name: id
                  type: BIGINT
                  autoIncrement: true
                  constraints:
                    primaryKey: true
                    nullable: false
              - column:
                  name: payment_group_id
                  type: BIGINT
                  constraints:
                    nullable: false
                    foreignKeyName: fk_payment_group
                    referencedTableName: payment_groups
                    referencedColumnNames: id
              - column:
                  name: end_to_end_identification
                  type: VARCHAR(255)
                  constraints:
                    nullable: false
                    unique: true
              - column:
                  name: currency
                  type: VARCHAR(3)
                  constraints:
                    nullable: false
              - column:
                  name: amount
                  type: DECIMAL(19, 2)
                  constraints:
                    nullable: false
              - column:
                  name: creditor_name
                  type: VARCHAR(255)
                  constraints:
                    nullable: false
              - column:
                  name: creditor_iban
                  type: VARCHAR(34)
                  constraints:
                    nullable: false
              - column:
                  name: remittance_information
                  type: VARCHAR(255)
